---
import DefaultPageLayout from '$/layouts/default.astro'
import PostPreviewList from '$/components/PostPreviewList.astro'
import Paginator from '$/components/Paginator.astro'
import { PAGE_SIZE } from '$/config'
import { SEO } from "astro-seo";
import Matomo from '@jop-software/astro-matomo'


let title = 'Blog'
let description = 'All the articles posted so far...'

export async function getStaticPaths({ paginate }) {
  const allPosts = await Astro.glob('./*.md');
  // @ts-ignore
  const sortedPosts = allPosts.sort((a: any, b: any): any => new Date(b.date) - new Date(a.date));

    return paginate(sortedPosts, {
      pageSize: PAGE_SIZE
    })
}

const { page } = Astro.props
---
<head>
  <SEO
      title="Un Bautista Dice"
      description="Enseñando por pasión a Cristo."
      extend={{
        // extending the default link tags
        link: [{ rel: "icon", href: "/favicon.ico" }],
        // extending the default meta tags
        meta: [
          {
            name: "twitter:image",
            content: "https://user-images.githubusercontent.com/5182256/131216951-8f74f425-f775-463d-a11b-0e01ad9fce8d.png",
          },
        ],
      }} />
      <!-- Matomo -->
<script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://unbautistadice.matomo.cloud/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='//cdn.matomo.cloud/unbautistadice.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->

</head>
<DefaultPageLayout content={{ title, description }}>
  <!-- <Matomo trackerUrl="https://unbautistadice.matomo.cloud/" siteId="1" /> -->
    <PostPreviewList posts={page.data} />
    <Paginator page={page} />
</DefaultPageLayout>
